"use strict";(self.webpackChunkMetaWall=self.webpackChunkMetaWall||[]).push([[319],{3319:(M,a,n)=>{n.r(a),n.d(a,{UserPostsModule:()=>S});var r=n(9808),d=n(8329),u=n(1810),g=n(9451),t=n(1223),m=n(2313),f=n(7556),h=n(9166),v=n(6341),x=n(5826),w=n(72),b=n(7007);function U(e,i){if(1&e&&(t.TgZ(0,"div",10)(1,"span",11),t._uU(2),t.ALo(3,"number"),t.qZA(),t._uU(4,"\u4eba\u8ffd\u8e64"),t.qZA()),2&e){const s=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,1,s.user.followers.length))}}function P(e,i){1&e&&t._uU(0,"\u53d6\u6d88")}function I(e,i){if(1&e){const s=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){return t.CHM(s),t.oxw(2).toggleFollow()}),t.YNc(1,P,1,0,"ng-template",13),t._uU(2,"\u8ffd\u8e64 "),t.qZA()}if(2&e){const s=t.oxw(2);t.Q6J("ngClass",s.isFollowing?"btn-light":"btn-warning"),t.xp6(1),t.Q6J("ngIf",s.isFollowing)}}function _(e,i){if(1&e){const s=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){return t.CHM(s),t.oxw(2).delPosts()}),t._uU(1,"\u522a\u9664\u6240\u6709\u8cbc\u6587"),t.qZA()}if(2&e){const s=t.oxw(2);t.Q6J("disabled",!s.posts.length)}}function C(e,i){if(1&e&&(t.TgZ(0,"div",3),t._UZ(1,"img",4),t.TgZ(2,"div",5)(3,"h6",6),t._uU(4),t.YNc(5,U,5,3,"div",7),t.qZA(),t.YNc(6,I,3,2,"button",8),t.YNc(7,_,2,1,"ng-template",null,9,t.W1O),t.qZA()()),2&e){const s=t.MAs(8),o=t.oxw();t.xp6(1),t.Q6J("src",o.user.photo?o.user.photo:o.userDefaultImg,t.LSH),t.xp6(3),t.Oqu(o.user.name),t.xp6(1),t.Q6J("ngIf",o.user.trackTotal),t.xp6(1),t.Q6J("ngIf",o.currentUserId!==o.userId)("ngIfElse",s)}}let p;const T=[{path:":id",component:(()=>{class e{constructor(s,o,l,c,y,J,Z){this.titleServer=s,this.route=o,this.authService=l,this.postService=c,this.memberService=y,this.swalDefaultService=J,this.spinner=Z,this.isFollowing=!1,this.posts=[],this.isLoading=!0,this.userDefaultImg=this.authService.userDefaultImg,p=this.swalDefaultService.toastDefault,this.spinner.hide()}get currentUserId(){var s;return null===(s=this.authService.user)||void 0===s?void 0:s.id}ngOnInit(){this.userId=this.route.snapshot.paramMap.get("id")}getPosts(s){this.isLoading=!0,this.userId&&this.postService.getUserPosts(this.userId,s).subscribe(o=>{this.user=o.user,this.titleServer.setTitle(`${this.user.name} - \u500b\u4eba\u7246 | ${g.Y.name}`),this.setIsFollowing(),this.posts=o.posts,setTimeout(()=>this.isLoading=!1,1e3)})}toggleFollow(){this.isFollowing?this.memberService.unfollow(this.user._id).subscribe(s=>{s.success&&(this.user.followers=s.data.followers,this.setIsFollowing()),this.setSwalToast(s.success,"\u53d6\u6d88\u8ddf\u96a8")}):this.memberService.addFollow(this.user._id).subscribe(s=>{s.success&&(this.user.followers=s.data.followers,this.setIsFollowing()),this.setSwalToast(s.success,"\u8ddf\u96a8")})}setSwalToast(s,o){p.fire({icon:s?"success":"error",title:`${o}${s?"\u6210\u529f":"\u5931\u6557"}`})}setIsFollowing(){this.isFollowing=this.user.followers.some(s=>s.user===this.currentUserId)}delPosts(){this.postService.delPosts().subscribe(s=>{s.success&&(this.posts=[]),this.setSwalToast(s.success,"\u522a\u9664\u5168\u90e8\u8cbc\u6587")})}}return e.\u0275fac=function(s){return new(s||e)(t.Y36(m.Dx),t.Y36(u.gz),t.Y36(f.e),t.Y36(h.L),t.Y36(v.n),t.Y36(x.K),t.Y36(w.t2))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-user-posts"]],decls:3,vars:3,consts:[["class","border rounded bg-white left-box-shadow d-flex align-items-center",4,"ngIf"],[1,"mt-4"],[3,"posts","isLoading","getPosts"],[1,"border","rounded","bg-white","left-box-shadow","d-flex","align-items-center"],[1,"user-img-size","border-end",3,"src"],[1,"flex-grow-1","text-truncate","d-flex","justify-content-between","align-items-center","px-4"],[1,"mb-0","fw-bold","text-truncate","me-4"],["class","fw-normal",4,"ngIf"],["type","button","class","btn py-1 px-5",3,"ngClass","click",4,"ngIf","ngIfElse"],["myself",""],[1,"fw-normal"],[1,"font-balooDa2","me-1"],["type","button",1,"btn","py-1","px-5",3,"ngClass","click"],[3,"ngIf"],["type","button",1,"btn","btn-danger","py-1","px-5",3,"disabled","click"]],template:function(s,o){1&s&&(t.YNc(0,C,9,5,"div",0),t.TgZ(1,"div",1)(2,"app-posts-group",2),t.NdJ("getPosts",function(c){return o.getPosts(c)}),t.qZA()()),2&s&&(t.Q6J("ngIf",o.user),t.xp6(2),t.Q6J("posts",o.posts)("isLoading",o.isLoading))},directives:[r.O5,r.mk,b.d],pipes:[r.JJ],styles:[".user-img-size[_ngcontent-%COMP%]{width:80px;height:80px;border-bottom-left-radius:inherit;border-top-left-radius:inherit}"]}),e})()}];let F=(()=>{class e{}return e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[u.Bz.forChild(T)],u.Bz]}),e})(),S=(()=>{class e{}return e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[r.ez,F,d._]]}),e})()}}]);