"use strict";(self.webpackChunkMetaWall=self.webpackChunkMetaWall||[]).push([[132],{4132:(P,p,s)=>{s.r(p),s.d(p,{AddPostModule:()=>B});var a=s(9808),i=s(2382),m=s(1442),r=s(1810),t=s(1223),g=s(9166),h=s(72),f=s(5826),A=s(9527);function C(e,l){if(1&e&&(t.TgZ(0,"div",13),t._uU(1,"\u5716\u7247\u7db2\u5740\u683c\u5f0f\u932f\u8aa4\uff0c\u9808\u70ba https \u70ba\u958b\u982d"),t.qZA()),2&e){t.oxw();const o=t.MAs(10);t.ekj("d-block",o.errors&&o.errors.pattern)}}let c;const v=[{path:"",component:(()=>{class e{constructor(o,n,d,u){this.router=o,this.postService=n,this.spinner=d,this.swalDefaultService=u,this.post={content:"",image:""},this.uploadErrs=[],this.spinner.hide(),c=this.swalDefaultService.toastDefault}ngOnInit(){}upload(o){if(this.uploadErrs.length=0,1===o.target.files.length){const n=o.target.files[0];if(-1===n.name.search(/\.(jpg|png)$/i)&&this.uploadErrs.push("\u5716\u7247\u683c\u5f0f\u932f\u8aa4\uff0c\u50c5\u9650 JPG\u3001PNG \u5716\u7247"),n.size/1024/1024>1&&this.uploadErrs.push("\u5716\u7247\u6a94\u6848\u904e\u5927\uff0c\u50c5\u9650 1mb \u4ee5\u4e0b\u6a94\u6848"),!this.uploadErrs.length){const d=new FileReader;d.onloadend=()=>{this.post.image=d.result},d.readAsDataURL(n)}}}delImage(){this.uploadErrs.length=0,this.post.image=""}trackByFn(o,n){return n}addPost(){this.spinner.show(),this.postService.addPost(this.post).subscribe(o=>{this.spinner.hide(),o&&c.fire({icon:o.success?"success":"error",title:"\u65b0\u589e\u8cbc\u6587"+(o.success?"\u6210\u529f":"\u5931\u6557")}).then(n=>{o.success&&this.router.navigate(["/index"])})})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(r.F0),t.Y36(g.L),t.Y36(h.t2),t.Y36(f.K))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-post"]],decls:15,vars:6,consts:[[3,"title"],[3,"ngSubmit"],["validateForm","ngForm"],[1,"card","mt-4"],[1,"card-body","p-6"],["for","postContent",1,"form-label"],["id","postContent","rows","5","placeholder","\u8f38\u5165\u60a8\u7684\u8cbc\u6587\u5167\u5bb9","name","content","required","",1,"form-control",3,"ngModel","ngModelChange"],["content","ngModel"],["type","text","placeholder","\u8acb\u8f38\u5165\u60a8\u7684\u8cbc\u6587\u5716\u7247\u7db2\u5740","name","image","id","name","pattern","^(https:\\/\\/)[^\\s]+",1,"form-control","my-4",3,"ngModel","ngModelChange"],["image","ngModel"],["class","invalid-feedback text-center",3,"d-block",4,"ngIf"],[1,"d-grid","gap-2","col-md-9","mx-auto","mt-4",3,"ngClass"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"invalid-feedback","text-center"]],template:function(o,n){if(1&o&&(t._UZ(0,"app-title",0),t.TgZ(1,"form",1,2),t.NdJ("ngSubmit",function(){return n.addPost()}),t.TgZ(3,"div",3)(4,"div",4)(5,"label",5),t._uU(6,"\u8cbc\u6587\u5167\u5bb9*"),t.qZA(),t.TgZ(7,"textarea",6,7),t.NdJ("ngModelChange",function(u){return n.post.content=u}),t.qZA(),t.TgZ(9,"input",8,9),t.NdJ("ngModelChange",function(u){return n.post.image=u}),t.qZA(),t.YNc(11,C,2,2,"div",10),t.TgZ(12,"div",11)(13,"button",12),t._uU(14,"\u9001\u51fa\u8cbc\u6587"),t.qZA()()()()()),2&o){const d=t.MAs(2),u=t.MAs(10);t.Q6J("title","\u5f35\u8cbc\u52d5\u614b"),t.xp6(7),t.Q6J("ngModel",n.post.content),t.xp6(2),t.Q6J("ngModel",n.post.image),t.xp6(2),t.Q6J("ngIf",u.invalid&&(u.dirty||u.touched)),t.xp6(1),t.Q6J("ngClass",d.invalid||n.uploadErrs.length?"mt-4":"mt-6"),t.xp6(1),t.Q6J("disabled",d.invalid||n.uploadErrs.length)}},directives:[A.r,i._Y,i.JL,i.F,i.Fj,i.Q7,i.JJ,i.On,i.c5,a.O5,a.mk],styles:[""]}),e})()}];let M=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[r.Bz.forChild(v)],r.Bz]}),e})(),B=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[a.ez,i.u5,M,m.i]]}),e})()}}]);